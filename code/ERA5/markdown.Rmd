---
title: "Downloading and processing CERRA-ERA5 data"
author: "Marta Pardo Araujo"
date: "17/4/2023"
output: html_document
---

Download the following packages

```{r setup, echo=TRUE,error =FALSE,message=FALSE}
rm(list=ls())
library(ncdf4)
library(tidyverse)
library(sf) 
library(raster)
library(terra)
library("mapSpain")
library(reticulate)
library(ncdf4)
library(parallel)
```

## Download data

In this document we download the temperature data for Spain from <https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-cerra-single-levels?tab=overview>.
A nice tutorial can be found in <https://dominicroye.github.io/en/2018/access-to-climate-reanalysis-data-from-r/>
This code is done to run in the cluster to parallelize the computation and save computational time. Could be run in local with Cores=1.\
First we need to login in Copernicus to obtain the API Key.
The first steps are:\
 . Create an account in <https://cds.climate.copernicus.eu/user/login?destination=%2F%23!%2Fhome>. \
 
 . Create a file .cdsapirc in your home path with the information in the black box (url, key) in <https://cds.climate.copernicus.eu/api-how-to>.


When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
